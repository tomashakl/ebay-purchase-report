<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>eBay Report — Config Generator</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;margin:24px;max-width:780px}
    label{display:block;margin-top:12px;font-weight:600}
    input[type=text], select {width:100%;padding:8px;margin-top:6px;border:1px solid #ccc;border-radius:6px}
    input[type=checkbox]{margin-right:8px}
    button{margin-top:18px;padding:10px 14px;border-radius:8px;border:0;background:#0366d6;color:#fff;font-weight:700}
    .warning{background:#fff4e5;border-left:4px solid #ffb86b;padding:10px;margin-top:12px;border-radius:6px}
    pre{background:#f6f8fa;padding:12px;border-radius:6px;overflow:auto}
  </style>
</head>
<body>
  <h1>eBay Report — Local Config Generator</h1>
  <p>Use this page locally (open the file in your browser) to produce a <code>config.json</code> or <code>config.yaml</code> for the script. <strong>Nothing is sent anywhere</strong> — the file is generated in your browser and downloaded to your machine.</p>

  <label>Author name
    <input id="author" type="text" placeholder="Duby or Your Name" value="">
  </label>

  <label>Year
    <input id="year" type="text" placeholder="2024" value="2024">
  </label>

  <label>eBay domain (site)
    <select id="site">
      <option value="co.uk">co.uk</option>
      <option value="com">com</option>
    </select>
  </label>

  <label><input id="headless" type="checkbox">Run headless</label>

  <label>Max pages to fetch
    <input id="maxpages" type="text" value="800">
  </label>

  <div class="warning">
    <strong>Security note:</strong> Do <em>not</em> store real passwords in this file if you plan to commit the repo or share it. Prefer to log in manually in the browser window opened by Selenium, or use OS secret stores / environment variables.
  </div>

  <button id="downloadJson">Download config.json</button>
  <button id="downloadYaml" style="margin-left:8px;background:#22a699">Download config.yaml</button>

  <h3>Preview</h3>
  <pre id="preview"></pre>

  <script>
    function buildConfig() {
      const cfg = {
        year: Number(document.getElementById('year').value) || 2024,
        site: document.getElementById('site').value || 'co.uk',
        headless: document.getElementById('headless').checked,
        max_pages: Number(document.getElementById('maxpages').value) || 800,
        author_name: document.getElementById('author').value || ''
      };
      return cfg;
    }

    function download(filename, text) {
      const a = document.createElement('a');
      a.href = URL.createObjectURL(new Blob([text], {type:'text/plain'}));
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      a.remove();
    }

    function toYAML(obj) {
      // very small YAML serializer for this use-case (no external libs)
      let out = '';
      for (const k of Object.keys(obj)) {
        const v = obj[k];
        if (typeof v === 'boolean' || typeof v === 'number') {
          out += `${k}: ${v}\n`;
        } else {
          // escape quotes in strings
          const s = String(v).replace(/"/g, '\"');
          out += `${k}: "${s}"\n`;
        }
      }
      return out;
    }

    const preview = document.getElementById('preview');
    function refreshPreview() {
      const cfg = buildConfig();
      preview.textContent = JSON.stringify(cfg, null, 2);
    }
    document.body.addEventListener('input', refreshPreview);
    refreshPreview();

    document.getElementById('downloadJson').addEventListener('click', () => {
      const cfg = buildConfig();
      download('config.json', JSON.stringify(cfg, null, 2));
    });
    document.getElementById('downloadYaml').addEventListener('click', () => {
      const cfg = buildConfig();
      download('config.yaml', toYAML(cfg));
    });
  </script>
</body>
</html>
